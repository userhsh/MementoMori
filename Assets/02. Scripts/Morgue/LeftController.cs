using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.InputSystem;
using UnityEngine.XR.Interaction.Toolkit;

public class LeftController : XRRayInteractor
{
    public InputActionReference menu; //메뉴 UI 켜는 키
    public InputActionReference collectionOn; //수집품 UI 켜는 키
    public InputActionReference collectionOff; //수집품 UI 끄는 키
    public GameObject UImenu; //메뉴 UI 오브젝트
    public GameObject UIcollection; //수집품 UI 오브젝트

    public GameObject LeftHandRender; //왼쪽 손 랜더러

    public GameObject UIItem;
    public Text UIItemText;


    private void Start()
    {
        menu.action.performed += MenuOn;
        collectionOn.action.performed += CollectionOn;
        collectionOff.action.performed += CollectionOff;
    }

    void MenuOn(InputAction.CallbackContext context) //메뉴 키 누를 시
    {
         UImenu.SetActive(true);
    }

    void CollectionOn(InputAction.CallbackContext context) //Y키 누를 시
    {
        UIcollection.SetActive(true);
        print("ui킴");
    }
    void CollectionOff(InputAction.CallbackContext context) //X키 누를 시
    {
        UIcollection.SetActive(false);
        print("ui끔");
    }

    public void LeftHandRenderIdle() //기존에 왼손랜더러 켜짐
    {
        LeftHandRender.SetActive(true);
    }

    public void LeftHandRenderGripping() //뭔가를 상호작용시 왼손랜더러 꺼짐
    {
        LeftHandRender.SetActive(false);
    }

    public bool isGrip = true;
    protected override void OnSelectEntered(XRBaseInteractable interactable)
    {
        isGrip = false;
    }

    protected override void OnSelectExited(XRBaseInteractable interactable)
    {
        isGrip = true;
    }

    protected override void OnHoverEntered(XRBaseInteractable interactable)
    {

        //if (interactable.transform.childCount != 0)
        //{
        //    interactable?.transform.GetChild(0).gameObject.SetActive(true);
        //    interactable.transform.GetChild(0).GetComponent<TextMesh>().text = "열기";
        //}

        if (isGrip)
        {
            switch (interactable.name)
            {
                case "Doll":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 인형";
                    break;
                case "Crowbar":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 크로우바";
                    break;
                case "MorgueKey":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 시체 안치실 열쇠";
                    break;
                case "DoctorCard":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 의사 카드";
                    break;
                case "CabinetKey":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 캐비넷 열쇠";
                    break;
                case "Pencil":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 연필";
                    break;
                case "OfficeKey":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 사무실 열쇠";
                    break;
                case "RemoCon":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 리모콘";
                    break;
                case "Flashlight":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 손전등";
                    break;
                case "Paper_None":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 빈(?)종이";
                    break;
                case "SurgeryKey":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 빈(?)종이";
                    break;
                case "Scalpel":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 메스";
                    break;
                case "PillowFabic_Medicine":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 깨끗한 천";
                    break;
                case "Medicine":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 약통";
                    break;
                case "PillowFabic":
                    UIItem.SetActive(true);
                    UIItemText.text = "아이템: 천";
                    break;
            }
        }


    }


    protected override void OnHoverExited(XRBaseInteractable interactable)
    {
        UIItemText.text = "";
        UIItem.SetActive(false);
    }
}
